### å‰ç«¯è¿‡æ¸¡å’ŒåŠ¨æ•ˆ

å‡è®¾æˆ‘ç°åœ¨æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼šåœ¨é¡µé¢ä¸Šè¦æœ‰ä¸€ä¸ª div æ ‡ç­¾ï¼Œä»¥åŠä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»é¡µé¢çš„æŒ‰é’®åï¼Œèƒ½å¤Ÿè®© div æ ‡ç­¾çš„å®½åº¦å¾—åˆ°å¢åŠ ã€‚

**é€šè¿‡ transition æ¥æ§åˆ¶ä¸€ä¸ªå…ƒç´ çš„å±æ€§çš„å€¼ï¼Œç¼“æ…¢åœ°å˜æˆå¦å¤–ä¸€ä¸ªå€¼ï¼Œè¿™ç§æ“ä½œå°±ç§°ä¹‹ä¸ºè¿‡æ¸¡ã€‚**

é™¤äº† transitionï¼Œè¿˜å¯ä»¥é€šè¿‡ animation å’Œ keyframe çš„ç»„åˆå®ç°åŠ¨ç”»ã€‚

[è¯¦è§](https://github.com/KurjaScript/geek-admain/commit/00c54d0f75b93060c9d03e3ac325d1c752535112)

### Vue 3 åŠ¨ç”»å…¥é—¨

[ä¸€ä¸ªå°èŒƒä¾‹](https://github.com/KurjaScript/geek-admain/commit/4e0823f6fa2466488e750c33514b6bfe45e0e80a)

![img](https://static001.geekbang.org/resource/image/af/e0/afeed23b2f92cac24de8b83fe3df80e0.gif?wh=460x290)

Vue 3 ä¸­æä¾›äº†ä¸€äº›åŠ¨ç”»çš„å°è£…ï¼Œä½¿ç”¨å†…ç½®çš„ transition ç»„ä»¶æ¥æ§åˆ¶ç»„ä»¶çš„åŠ¨ç”»ã€‚

å…·ä½“ class çš„åå­—ï¼ŒVue çš„å®˜ç½‘æœ‰ä¸€ä¸ªå›¾ç»™å‡ºäº†å¾ˆå¥½çš„è§£é‡Šï¼Œå›¾é‡Œçš„ v-enter-from ä¸­çš„ vï¼Œå°±æ˜¯æˆ‘ä»¬è®¾ç½®çš„ name å±æ€§ã€‚æ‰€ä»¥åœ¨æˆ‘ä»¬ç°åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæ ‡ç­¾åœ¨è¿›å…¥å’Œç¦»å¼€çš„æ—¶å€™ï¼Œä¼šæœ‰ fade-enter-active å’Œ fade-leave-active çš„ classï¼Œè¿›å…¥çš„å¼€å§‹å’Œç»“æŸä¼šæœ‰ fade-enter-from å’Œ face-enter-to ä¸¤ä¸ª classã€‚

![img](https://static001.geekbang.org/resource/image/71/92/718a6019316ed75f6d040e4983957692.png?wh=1920x866)

### æ¸…å•åº”ç”¨ä¼˜åŒ–

Todolist æ¸…å•å‡ºç°äº†ä¸€ä¸ªæ–°çš„éœ€æ±‚ï¼šå½“è¾“å…¥æ¡†ä¸ºç©ºçš„æ—¶å€™ï¼Œæ•²å‡»å›è½¦éœ€è¦å¼¹å‡ºä¸€ä¸ªé”™è¯¯æç¤ºã€‚

[è¯¦è§](https://github.com/KurjaScript/geek-admain/commit/ac37ed031b008e38bb6620ac7b5cc5c071078abd)

### åˆ—è¡¨åŠ¨ç”»

**åˆ—è¡¨è¿‡æ¸¡éœ€æ±‚**ï¼šå®ç°åˆ—è¡¨ä¾æ¬¡åŠ¨ç”»å‡ºç°çš„æ•ˆæœã€‚

å› ä¸º transition ç»„ä»¶ä¼šæŠŠå­å…ƒç´ ä½œä¸ºä¸€ä¸ªæ•´ä½“åŒæ—¶å»è¿‡æ¸¡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–°çš„å†…ç½®ç»„ä»¶ transition-groupã€‚åœ¨ v-for æ¸²æŸ“åˆ—è¡¨çš„åœºæ™¯ä¹‹ä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ transition-group ç»„ä»¶å»åŒ…è£¹å…ƒç´ ï¼Œé€šè¿‡ tag å±æ€§å»æŒ‡å®šæ¸²æŸ“ä¸€ä¸ªå…ƒç´ ã€‚

æ­¤å¤–ï¼Œtransition-group ç»„ä»¶è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šä¹‹å¤„ï¼Œå°±æ˜¯ä¸ä»…å¯ä»¥è¿›å…¥å’Œç¦»å¼€åŠ¨ç”»ï¼Œè¿˜å¯ä»¥æ”¹å˜å®šä½ã€‚å°±å’Œä¹‹å‰çš„ç±»åä¸€æ ·ï¼Œè¿™ä¸ªåŠŸèƒ½æ–°å¢äº† v-move ç±»ï¼Œåœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œä½¿ç”¨ transition-group åŒ…è£¹æ¸²æŸ“çš„ li å…ƒç´ ï¼Œå¹¶ä¸”è®¾ç½®åŠ¨ç”»çš„ name å±æ€§ä¸º flip-listã€‚ç„¶åæˆ‘ä»¬æ ¹æ® v-move çš„å‘½åè§„èŒƒï¼Œè®¾ç½® .flip-list-move çš„è¿‡æ¸¡å±æ€§ï¼Œå°±å®ç°äº†åˆ—è¡¨ä¾æ¬¡å‡ºç°çš„æ•ˆæœäº†ã€‚

![img](https://static001.geekbang.org/resource/image/0b/a7/0b68e2ec1b617461f198094bd643aea7.gif?wh=646x463)

[è¯¦è§](https://github.com/KurjaScript/geek-admain/commit/a79f5c58f9bbf006a0e1ec6ddd2f8030d192b940)

### é¡µé¢åˆ‡æ¢åŠ¨ç”»

**ç”»åˆ‡æ¢åœºæ™¯çš„æ ¸å¿ƒåŸç†å’Œå¼¹çª—åŠ¨ç”»æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯é€šè¿‡ transition æ ‡ç­¾æ§åˆ¶é¡µé¢è¿›å…¥å’Œç¦»å¼€çš„ classã€‚**

ç°åœ¨é»˜è®¤æ˜¯åœ¨ vue-router çš„æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ router-view ç»„ä»¶è¿›è¡ŒåŠ¨æ€çš„ç»„ä»¶æ¸²æŸ“ã€‚åœ¨è·¯ç”±å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®¡ç®—å‡ºå¯¹åº”åŒ¹é…çš„ç»„ä»¶å»å¡«å…… router-viewã€‚

**å¦‚æœè¦åœ¨è·¯ç”±ç»„ä»¶ä¸Šä½¿ç”¨è½¬åœºï¼Œå¹¶ä¸”å¯¹å¯¼èˆªè¿›è¡ŒåŠ¨ç”»å¤„ç†ï¼Œéœ€è¦ä½¿ç”¨ v-slot APIã€‚**

```html
// å®æ“æŠ¥é”™ï¼Œå¿…é¡»æœ‰ä¸€ä¸ª root å…ƒç´ æ‰ç”Ÿæ•ˆ
<router-view v-slot="{ Component }">
  <transition  name="route" mode="out-in">
    <component :is="Component" />
  </transition>
</router-view>
```

ä»¥ä¸Šä»£ç ï¼Œrouter-view é€šè¿‡ v-slot è·å–æ¸²æŸ“çš„ç»„ä»¶å¹¶ä¸”èµ‹å€¼ç»™ Componentï¼Œç„¶åä½¿ç”¨ transition åŒ…è£¹éœ€è¦æ¸²æŸ“çš„ç»„ä»¶ï¼Œå¹¶ä¸”é€šè¿‡å†…ç½®ç»„ä»¶ component çš„ is å±æ€§åŠ¨æ€æ¸²æŸ“ç»„ä»¶ã€‚

### JavaScript åŠ¨ç”»

åœ¨å‰ç«¯çš„å¤§éƒ¨åˆ†äº¤äº’åœºæ™¯ä¸­ï¼ŒåŠ¨ç”»çš„ä¸»è¦ç›®çš„æ˜¯æé«˜äº¤äº’ä½“éªŒï¼ŒCSS åŠ¨ç”»è¶³ä»¥åº”å¯¹å¤§éƒ¨åˆ†åœºæ™¯ã€‚**ä½†å¦‚æœç¢°è§æ¯”è¾ƒå¤æ‚çš„åŠ¨ç”»åœºæ™¯ï¼Œå°±éœ€è¦ç”¨ JavaScript æ¥å®ç°ï¼Œæ¯”å¦‚è´­ç‰©è½¦ã€åœ°å›¾ç­‰åœºæ™¯ã€‚**

![img](https://static001.geekbang.org/resource/image/5a/b2/5afba5a388f940995c39de50d04f7fb2.gif?wh=661x381)

[è¯¦è§](https://github.com/KurjaScript/geek-admain/commit/753fb31cea00261d955fa46870bfb639d778adbd)

è¿›ä¸€æ­¥å®ç°ä¸€ä¸ªå¤æ‚çš„åŠ¨ç”»åŠŸèƒ½ï¼šç‚¹å‡»åˆ é™¤ï¼Œå®ç°å›¾æ ‡é£åˆ°åºŸçº¸ç¯“çš„åŠ¨ç”»ã€‚

å®ç°æ€è·¯ï¼šæˆ‘ä»¬æ”¾ä¸€ä¸ªå•ç‹¬å­˜åœ¨çš„åŠ¨ç”»å…ƒç´ å¹¶ä¸”è—èµ·æ¥ï¼Œå½“ç‚¹å‡»åˆ é™¤å›¾æ ‡çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªåŠ¨ç”»å…ƒç´ ç§»åŠ¨åˆ°é¼ æ ‡çš„ä½ç½®ï¼Œå†é£åˆ°åºŸçº¸ç¯“é‡Œè—èµ·æ¥å°±å¯ä»¥äº†ã€‚

```vue

<template>
    <span class="dustbin">
      ğŸ—‘
    </span>
<div class="animate-wrap">
    <transition @before-enter="beforeEnter" @enter="enter" @after-enter="afterEnter">
        <div class="animate" v-show="animate.show">
            ğŸ“‹
        </div>
    </transition>
</div>
</template>

<script setup>

let animate = reactive({
  show:false,
  el:null
})
function beforeEnter(el){
      let dom = animate.el
      let rect = dom.getBoundingClientRect()
      let x = window.innerWidth - rect.left - 60
      let y = rect.top - 10
      el.style.transform = `translate(-${x}px, ${y}px)`
}
function enter(el,done){
      document.body.offsetHeight
      el.style.transform = `translate(0,0)`
      el.addEventListener('transitionend', done)
}
function afterEnter(el){
      animate.show = false
      el.style.display = 'none'
}
function removeTodo(e,i){
  animate.el = e.target
  animate.show = true
  todos.value.splice(i,1)
}
</script>
<style>
.animate-wrap .animate{
    position :fixed;
    right :10px;
    top :10px;
    z-index: 100;
    transition: all 0.5s linear;
}
</style>
```

ä»¥ä¸Šä»£ç ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰äº† animate å“åº”å¼å¯¹è±¡æ¥æ§åˆ¶åŠ¨ç”»å…ƒç´ çš„æ˜¾ç¤ºå’Œéšè—ï¼Œå¹¶ä¸”ç”¨ transition æ ‡ç­¾åŒ…è£¹åŠ¨ç”»å…ƒç´ ã€‚åœ¨ beforeEnter å‡½æ•°ä¸­ï¼Œé€šè¿‡ getBoundingClientRect å‡½æ•°è·å–é¼ æ ‡çš„ç‚¹å‡»ä½ç½®ï¼Œè®©åŠ¨ç”»å…ƒç´ é€šè¿‡ translate å±æ€§ç§»åŠ¨åˆ°é¼ æ ‡æ‰€åœ¨ä½ç½®ï¼›å¹¶ä¸”åœ¨ enter é’©å­ä¸­ï¼ŒæŠŠåŠ¨ç”»å…ƒç´ ç§»åŠ¨åˆ°åˆå§‹ä½ç½®ï¼Œåœ¨ afterEnter ä¸­ï¼Œä¹Ÿå°±æ˜¯åŠ¨ç”»ç»“æŸåï¼ŒæŠŠåŠ¨ç”»å…ƒç´ å†éšè—èµ·æ¥ï¼Œè¿™æ ·å°±å®ç°äº†ç±»ä¼¼è´­ç‰©è½¦çš„é£å…¥æ•ˆæœã€‚